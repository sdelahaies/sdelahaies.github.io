<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Sylvain Delahaies</title>
  <meta content="" name="description">
  <meta content="" name="keywords">
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">
  <link href="assets/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/css/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/css/swiper-bundle.min.css" rel="stylesheet">
  <!--<link href="assets/css/style.css" rel="stylesheet">-->
  <link href="assets/css/style_blog.css" rel="stylesheet">
  <link href="assets/css/font-awesome.min.css" rel="stylesheet">

  <!--<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />-->

    <script>
       window.MathJax = {
         tags: 'ams',
         tex: {
           inlineMath: [ ['$', '$'],['##','##'], ["\\(","\\)"] ],
           displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
           processEscapes: true,
           packages: {'[+]': ['noerrors']}
         },
         chtml: {
           displayAlign: "left"
         },
         options: {
           processHtmlClass: 'cmath|dmath',
           ignoreHtmlClass: 'tex2jax_ignore'
         },
         loader: {
           load: ['input/tex','output/chtml','[tex]/noerrors','ui/lazy']
         }
       };
    </script>
    <script>
        MathJax = {
          loader: {
            load: ['input/tex-base', 'output/svg', 'ui/menu', '[tex]/require']
          },
          tex: {
            packages: ['base', 'require']
          }
        };
        </script>
        <script type="text/javascript" id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3.0.0/es5/startup.js">
        </script>

</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top">
    <div class="container d-flex align-items-center justify-content-between">
      <a href="index.html" class="logo"><img src="assets/img/logo_1_w.png" alt="" class="img-fluid"></a>
      <!--
      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto active" href="#EnBref">En bref</a></li>
          <li><a class="nav-link scrollto" href="#skills">Comp√©tences</a></li>
          <li><a class="nav-link scrollto" href="#work">Projets</a></li>
          <li><a class="nav-link scrollto" href="#experience">Parcours</a></li>
          <li><a class="nav-link active" href="index.html" style="text-transform:none">Fr</a></li>
          <li><a class="nav-link" href="index_en.html" style="text-transform:none">En</a></li>
        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav>
      -->

    </div>
  </header><!-- End Header -->


  <div class="hero hero-single route " style="background-image: url(assets/img/DE_spark.png)">
    <div class="overlay-mf"></div>
    <div class="hero-content display-table">
      <div class="table-cell">
        <div class="container">
          <h2 class="hero-title mb-4">Projects & Research</h2>
          <!--
          <ol class="breadcrumb d-flex justify-content-center">
            <li class="breadcrumb-item">
              <a href="#">Home</a>
            </li>
            <li class="breadcrumb-item">
              <a href="#">Library</a>
            </li>
            <li class="breadcrumb-item active">Data</li>
          </ol>
        -->
        </div>
      </div>
    </div>
  </div>


  <main id="main">

    <!-- ======= Blog Single Section ======= -->
    <section class="blog-wrapper sect-pt4" id="blog">
      <div class="container">
        <div class="row">
          <div class="col-md-8">
            <div class="post-box">
              <div class="post-thumb">
                <img src="assets/img/post-1.jpg" class="img-fluid" alt="">
              </div>
              <div class="post-meta">
                <h1 class="article-title" id="1">Online EnPGF training for temporal point processes</h1>
                <ul>
                  <li>
                    <span class="bi bi-person"></span>
                    <a href="#">S. Delahaies</a>
                  </li>
                  <li>
                    <span class="bi bi-tag"></span>
                    <a href="#">Data Science/Engineering</a>
                  </li>
                </ul>
              </div>
              <div class="article-text" >
                <p>
                  This article builds on the work carried out at the university of Surrey with my colleagues Pr. D. Lloyd and Dr N. Santitissadeekorn
                  about ensemble filters for temporal point processes. The following pytorch implementation of the Ensemble Poisson Gamma Filter (EnPGF), conf. <a href="#ref1">[1]</a>,<a href="#ref2">[2]</a>, provides unprecedented computational capabilities. The potential of this new torch-EnPGF is illustrated with an online training simulation framework using apache kafka.
                </p>

                <h4>Content</h4>
                <h6 style="margin-left:30px"><a href="#TPP">Temporal point processes</a></h6>
                <h6 style="margin-left:30px"><a href="#EnPGF">Ensemble Poisson-Gamma Filter</a></h6>
                <h6 style="margin-left:30px"><a href="#PI">Pytorch implementation</a></h6>
                <h6 style="margin-left:30px"><a href="#ENE">EnPGF Network Explorer</a></h6>
                <h6 style="margin-left:30px"><a href="#AKOTF">Apache kafka online training framework</a></h6>
                <h6 style="margin-left:30px"><a href="#CODE">Source code</a></h6>
                <h6 style="margin-left:30px"><a href="#REF">References</a></h6>

                <p></p>
                <h4 id="TPP">Temporal point processes</h4>
                <p>Temporal point processes provide a robust mathematical framework to investigate asynchronous event sequences that arise in many real-world applications. A non exhaustive list of relevant areas of application includes earthquake modelling, communication network analysis, neurons activity, epidemic outbreak, market stock price changes ... 
                
                Formally, given a history \( \mathcal{H}_t := \lbrace (i',t') | t' < t, i' \in \mathcal{I} \rbrace  \) for a set of event types \(\mathcal{I}\), a multivariate temporal point process is determined by the intensity function \(\Lambda := \lbrace \lambda^i\rbrace_{i\in\mathcal{I}} \) where
                
                $$ \lambda^i(t)  = \lim_{dt\rightarrow 0} \frac{P(\text{event i occurs in }[t,t+dt) | \mathcal{H}_t)}{dt}. $$
                    
                Here we consider a discrete multivariate Hawkes process where the intensity function at time \(t_{k+1}\) is defined by
            
                $$ \lambda^i_{k+1}=\mu^i+(\lambda^i_k-\mu^i)(1-\beta^i\delta t) +\sum_{j\in \mathcal{I}}\alpha^{ij}d N^j_k, $$
                
                for a baseline intensity \(\mu^i>0\), decay rate \(\beta^i>0\) and excitation matrix \( \alpha^{ij}\), \(i,j \in \mathcal{I}\), and counting process \(N^j_n:=N^j(t_k):= \#\mathcal{H}^j_{t_k}\) . 
                </p>    
                <p>
                Given the history \(\mathcal{H}\) our aim is to learn the model parameters \(\lbrace \mu^i,\beta^i,\alpha^{ij} \rbrace_{i,j \in \mathcal{I}}\) .
                </p>
                <figure>
                    <img class="w-100" src="assets/img/events.png">
                    <figcaption   style="text-align: center">Fig 1: example of a multivariate Hawkes process.</figcaption>
                  </figure> 

                
                <h4 id="EnPGF">Ensemble Poisson-Gamma Filter</h4>
                For a complete account of EnPGF please refer to Santitissadeekorn et al. <a href="#ref1">[1]</a>,<a href="#ref2">[2]</a>. In a nutshell, just like any other EnKF-like filter,  EnPGF consists of three main stages:
                <li style="margin-left:30px"><b>analysis</b>: following a stochastic update formula the ensemble members for the intensities are moved consistently with a poisson-gamma conjugacy principle,</li>
                <li style="margin-left:30px"><b>update</b>: the innovations in terms of the intensities are linearly regressed on the ensemble of corresponding parameters,</li> 
                <li style="margin-left:30px"><b>forecast</b>: finally the sequential model with updated parameters is applied to forecast the next ensemble intensities.</li>
                <p></p>

                <h4 id="PI">Pytorch Implementation</h4>
                <p>
                From the start we clearly indentified EnPGf as a good condidate for large problems for offline (full time window) training, and very large problems for online (sequential) training. Although we implemented many python parallel versions of EnPGF, using various libraries such as numba, ray, pyopencl, multiprocessing,... and deployed them on Surrey HPC facilities, and despite some conforting results as compared to other existing methods, up until now we couldn't really unleash EnPGF full potential. Well, thanks to a brand new GPU and a deep detour into deep learning and the magic of pytorch and so on, we finally obtained a couple of order of magnitude gain in computational time and memory use, allowing for much bigger simulations... 
                </p>  

                <div class="demo-highlight">
                  <pre><span></span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">matmul</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
                  
<span class="k">class</span> <span class="nc">EnPGF</span><span class="p">():</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">nens</span><span class="p">,</span><span class="n">dN</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">device</span><span class="o">=</span><span class="s1">'cpu'</span><span class="p">,</span><span class="n">inflation</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
      <span class="n">rdn1</span><span class="p">,</span><span class="n">rdn2</span><span class="p">,</span><span class="n">rdn3</span> <span class="o">=</span> <span class="n">init_random_sets</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">nens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">nens</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">rnd1</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rnd1</span><span class="o">.</span><span class="n">copy</span><span class="p">()))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rnd2</span><span class="o">.</span><span class="n">copy</span><span class="p">()))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rnd3</span><span class="o">.</span><span class="n">copy</span><span class="p">()))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">dN</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">dN</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="o">...</span>
  
  <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nstep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">reset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">nstep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
          <span class="n">nstep</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dN</span><span class="p">)</span>
      <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">amp</span><span class="o">.</span><span class="n">autocast</span><span class="p">():</span>
          <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span> 
              <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">nstep</span><span class="p">)):</span>
                  <span class="n">kk</span><span class="p">,</span><span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__analysis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dN</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">__update_mu</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">__update_beta</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">__update_alpha</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">__forecast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dN</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
                  <span class="k">if</span> <span class="n">reset</span> <span class="ow">and</span> <span class="n">i</span><span class="o">%</span><span class="mi">500</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
                  </pre></div>
                  <style id="css-style">pre { line-height: 125%; }
                  td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
                  span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
                  td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
                  span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
                  .demo-highlight .hll { background-color: #ffffcc }
                  .demo-highlight { background: #f8f8f8; }
                  .demo-highlight .c { color: #008800; font-style: italic } /* Comment */
                  .demo-highlight .err { border: 1px solid #FF0000 } /* Error */
                  .demo-highlight .k { color: #AA22FF; font-weight: bold } /* Keyword */
                  .demo-highlight .o { color: #666666 } /* Operator */
                  .demo-highlight .ch { color: #008800; font-style: italic } /* Comment.Hashbang */
                  .demo-highlight .cm { color: #008800; font-style: italic } /* Comment.Multiline */
                  .demo-highlight .cp { color: #008800 } /* Comment.Preproc */
                  .demo-highlight .cpf { color: #008800; font-style: italic } /* Comment.PreprocFile */
                  .demo-highlight .c1 { color: #008800; font-style: italic } /* Comment.Single */
                  .demo-highlight .cs { color: #008800; font-weight: bold } /* Comment.Special */
                  .demo-highlight .gd { color: #A00000 } /* Generic.Deleted */
                  .demo-highlight .ge { font-style: italic } /* Generic.Emph */
                  .demo-highlight .gr { color: #FF0000 } /* Generic.Error */
                  .demo-highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
                  .demo-highlight .gi { color: #00A000 } /* Generic.Inserted */
                  .demo-highlight .go { color: #888888 } /* Generic.Output */
                  .demo-highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
                  .demo-highlight .gs { font-weight: bold } /* Generic.Strong */
                  .demo-highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
                  .demo-highlight .gt { color: #0044DD } /* Generic.Traceback */
                  .demo-highlight .kc { color: #AA22FF; font-weight: bold } /* Keyword.Constant */
                  .demo-highlight .kd { color: #AA22FF; font-weight: bold } /* Keyword.Declaration */
                  .demo-highlight .kn { color: #AA22FF; font-weight: bold } /* Keyword.Namespace */
                  .demo-highlight .kp { color: #AA22FF } /* Keyword.Pseudo */
                  .demo-highlight .kr { color: #AA22FF; font-weight: bold } /* Keyword.Reserved */
                  .demo-highlight .kt { color: #00BB00; font-weight: bold } /* Keyword.Type */
                  .demo-highlight .m { color: #666666 } /* Literal.Number */
                  .demo-highlight .s { color: #BB4444 } /* Literal.String */
                  .demo-highlight .na { color: #BB4444 } /* Name.Attribute */
                  .demo-highlight .nb { color: #AA22FF } /* Name.Builtin */
                  .demo-highlight .nc { color: #0000FF } /* Name.Class */
                  .demo-highlight .no { color: #880000 } /* Name.Constant */
                  .demo-highlight .nd { color: #AA22FF } /* Name.Decorator */
                  .demo-highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
                  .demo-highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
                  .demo-highlight .nf { color: #00A000 } /* Name.Function */
                  .demo-highlight .nl { color: #A0A000 } /* Name.Label */
                  .demo-highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
                  .demo-highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
                  .demo-highlight .nv { color: #B8860B } /* Name.Variable */
                  .demo-highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
                  .demo-highlight .w { color: #bbbbbb } /* Text.Whitespace */
                  .demo-highlight .mb { color: #666666 } /* Literal.Number.Bin */
                  .demo-highlight .mf { color: #666666 } /* Literal.Number.Float */
                  .demo-highlight .mh { color: #666666 } /* Literal.Number.Hex */
                  .demo-highlight .mi { color: #666666 } /* Literal.Number.Integer */
                  .demo-highlight .mo { color: #666666 } /* Literal.Number.Oct */
                  .demo-highlight .sa { color: #BB4444 } /* Literal.String.Affix */
                  .demo-highlight .sb { color: #BB4444 } /* Literal.String.Backtick */
                  .demo-highlight .sc { color: #BB4444 } /* Literal.String.Char */
                  .demo-highlight .dl { color: #BB4444 } /* Literal.String.Delimiter */
                  .demo-highlight .sd { color: #BB4444; font-style: italic } /* Literal.String.Doc */
                  .demo-highlight .s2 { color: #BB4444 } /* Literal.String.Double */
                  .demo-highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
                  .demo-highlight .sh { color: #BB4444 } /* Literal.String.Heredoc */
                  .demo-highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
                  .demo-highlight .sx { color: #008000 } /* Literal.String.Other */
                  .demo-highlight .sr { color: #BB6688 } /* Literal.String.Regex */
                  .demo-highlight .s1 { color: #BB4444 } /* Literal.String.Single */
                  .demo-highlight .ss { color: #B8860B } /* Literal.String.Symbol */
                  .demo-highlight .bp { color: #AA22FF } /* Name.Builtin.Pseudo */
                  .demo-highlight .fm { color: #00A000 } /* Name.Function.Magic */
                  .demo-highlight .vc { color: #B8860B } /* Name.Variable.Class */
                  .demo-highlight .vg { color: #B8860B } /* Name.Variable.Global */
                  .demo-highlight .vi { color: #B8860B } /* Name.Variable.Instance */
                  .demo-highlight .vm { color: #B8860B } /* Name.Variable.Magic */
                  .demo-highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>

                <p>As an example, the picture below shows the true and trained excitation matrices for a simulation with \(n=128\) nodes, \(nens=128\) ensemble members, for \(10^5\) training steps. </p>
                
                  <div class="demo-highlight">
                    <pre>
<span></span><span class="n">dN</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">nstep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dN_load</span><span class="p">(</span><span class="s1">'dN_100000_128.csv.gzip'</span><span class="p">)</span>
<span class="n">enpgf</span><span class="o">=</span><span class="w"> </span><span class="n">EnPGF</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">nens</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span><span class="n">dN</span><span class="o">=</span><span class="n">dN</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">device</span><span class="o">=</span><span class="s1">'cuda'</span><span class="p">)</span>
<span class="n">enpgf</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
                    
<span class="n">enpgf</span><span class="o">.</span><span class="n">display_alpha</span><span class="p">(</span><span class="n">truth</span><span class="o">=</span><span class="s2">"synth_data/alphat_128_b.csv"</span><span class="p">)</span>
                    </pre>
                  </div>
                    <style id="css-style">pre { line-height: 125%; }
                    td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
                    span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
                    td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
                    span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
                    .demo-highlight .hll { background-color: #ffffcc }
                    .demo-highlight { background: #f8f8f8; }
                    .demo-highlight .c { color: #008800; font-style: italic } /* Comment */
                    .demo-highlight .err { border: 1px solid #FF0000 } /* Error */
                    .demo-highlight .k { color: #AA22FF; font-weight: bold } /* Keyword */
                    .demo-highlight .o { color: #666666 } /* Operator */
                    .demo-highlight .ch { color: #008800; font-style: italic } /* Comment.Hashbang */
                    .demo-highlight .cm { color: #008800; font-style: italic } /* Comment.Multiline */
                    .demo-highlight .cp { color: #008800 } /* Comment.Preproc */
                    .demo-highlight .cpf { color: #008800; font-style: italic } /* Comment.PreprocFile */
                    .demo-highlight .c1 { color: #008800; font-style: italic } /* Comment.Single */
                    .demo-highlight .cs { color: #008800; font-weight: bold } /* Comment.Special */
                    .demo-highlight .gd { color: #A00000 } /* Generic.Deleted */
                    .demo-highlight .ge { font-style: italic } /* Generic.Emph */
                    .demo-highlight .gr { color: #FF0000 } /* Generic.Error */
                    .demo-highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
                    .demo-highlight .gi { color: #00A000 } /* Generic.Inserted */
                    .demo-highlight .go { color: #888888 } /* Generic.Output */
                    .demo-highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
                    .demo-highlight .gs { font-weight: bold } /* Generic.Strong */
                    .demo-highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
                    .demo-highlight .gt { color: #0044DD } /* Generic.Traceback */
                    .demo-highlight .kc { color: #AA22FF; font-weight: bold } /* Keyword.Constant */
                    .demo-highlight .kd { color: #AA22FF; font-weight: bold } /* Keyword.Declaration */
                    .demo-highlight .kn { color: #AA22FF; font-weight: bold } /* Keyword.Namespace */
                    .demo-highlight .kp { color: #AA22FF } /* Keyword.Pseudo */
                    .demo-highlight .kr { color: #AA22FF; font-weight: bold } /* Keyword.Reserved */
                    .demo-highlight .kt { color: #00BB00; font-weight: bold } /* Keyword.Type */
                    .demo-highlight .m { color: #666666 } /* Literal.Number */
                    .demo-highlight .s { color: #BB4444 } /* Literal.String */
                    .demo-highlight .na { color: #BB4444 } /* Name.Attribute */
                    .demo-highlight .nb { color: #AA22FF } /* Name.Builtin */
                    .demo-highlight .nc { color: #0000FF } /* Name.Class */
                    .demo-highlight .no { color: #880000 } /* Name.Constant */
                    .demo-highlight .nd { color: #AA22FF } /* Name.Decorator */
                    .demo-highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
                    .demo-highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
                    .demo-highlight .nf { color: #00A000 } /* Name.Function */
                    .demo-highlight .nl { color: #A0A000 } /* Name.Label */
                    .demo-highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
                    .demo-highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
                    .demo-highlight .nv { color: #B8860B } /* Name.Variable */
                    .demo-highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
                    .demo-highlight .w { color: #bbbbbb } /* Text.Whitespace */
                    .demo-highlight .mb { color: #666666 } /* Literal.Number.Bin */
                    .demo-highlight .mf { color: #666666 } /* Literal.Number.Float */
                    .demo-highlight .mh { color: #666666 } /* Literal.Number.Hex */
                    .demo-highlight .mi { color: #666666 } /* Literal.Number.Integer */
                    .demo-highlight .mo { color: #666666 } /* Literal.Number.Oct */
                    .demo-highlight .sa { color: #BB4444 } /* Literal.String.Affix */
                    .demo-highlight .sb { color: #BB4444 } /* Literal.String.Backtick */
                    .demo-highlight .sc { color: #BB4444 } /* Literal.String.Char */
                    .demo-highlight .dl { color: #BB4444 } /* Literal.String.Delimiter */
                    .demo-highlight .sd { color: #BB4444; font-style: italic } /* Literal.String.Doc */
                    .demo-highlight .s2 { color: #BB4444 } /* Literal.String.Double */
                    .demo-highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
                    .demo-highlight .sh { color: #BB4444 } /* Literal.String.Heredoc */
                    .demo-highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
                    .demo-highlight .sx { color: #008000 } /* Literal.String.Other */
                    .demo-highlight .sr { color: #BB6688 } /* Literal.String.Regex */
                    .demo-highlight .s1 { color: #BB4444 } /* Literal.String.Single */
                    .demo-highlight .ss { color: #B8860B } /* Literal.String.Symbol */
                    .demo-highlight .bp { color: #AA22FF } /* Name.Builtin.Pseudo */
                    .demo-highlight .fm { color: #00A000 } /* Name.Function.Magic */
                    .demo-highlight .vc { color: #B8860B } /* Name.Variable.Class */
                    .demo-highlight .vg { color: #B8860B } /* Name.Variable.Global */
                    .demo-highlight .vi { color: #B8860B } /* Name.Variable.Instance */
                    .demo-highlight .vm { color: #B8860B } /* Name.Variable.Magic */
                    .demo-highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
                  
                <figure>
                  <img class="w-100" src="assets/img/alpha.png">
                  <figcaption   style="text-align: center">Fig 2: on the left the true excitation matrix, on the right the mean EnPGF trained excitation matrix.</figcaption>
                </figure>   

                <p>The run performed on a RTX 3080 takes a little more than 2 minutes to complete, that is more or less 15 times faster than our previous results. The implementation merits further improvements to allow for a more efficient memory use.</p>
                <p></p>

                <h4 id="ENE">EnPGF Network explorer</h4>  
                <p>Understanding the network structure of the problem at hand can become quite difficult as the number of nodes increases. To provide better insights into the infuence/excitation relationship (ref <a href="#ref1">[1]</a>) between nodes we implemented a dash-cytoscape dashboard app. The app takes the output of an EnPGF training and uses dash-cytoscape to enlight us with meaningful influential structures.</p>

                <figure>
                  <img class="w-75" src="assets/img/enpgf_explorer.gif">
                  <figcaption   style="text-align:left">Fig 3: EnPGF explorer dashboard for a 512 nodes, fully connected, simulation.</figcaption>
                </figure> 

                <h4 id="AKOTF">Apache kafka online training framework</h4>
                <p>
                The example presented above is yet relatively small and although larger simulation could be performed to demonstrate the training capabilities of EnPGF, we prefer teasing one advantage of EnPGF over other methods, namely, its sequential nature. While most other methods learn from a whole history at once, EnPGF can handle new events as they happen allowing for online training with streamed data. 
               </p>
               <p>To illustrate this feature of EnPGF we propose the following online training simulation framework using <b>apache kafka</b>. We define:
                <li style="margin-left:30px"><b>a producer: </b> reading settings from a configuration file <tt>sim_events.yml</tt>, the discrete model produces events data. We can easily think of real-world applications where the data could be spikes trains of isolated neurons, user activity on a communication network, ...</li>
                <li style="margin-left:30px"><b>a consumer: </b>reading settings from the configuration file, the consumer initialises a EnPFG instance and waits for the data stream topic to perform the training.</li>
                The consumer can be adatped to save the model regularly to allow for a monitoring of the online training using the EnPGF explorer dashboard.   
              </p>

                <figure>
                  <img class="w-100" src="assets/img/kafka_streaming.gif">
                  <figcaption   style="text-align:left">Fig 3: EnPGF online learning simulation with 1024 nodes using kafka.</figcaption>
                </figure>        
               
                <h4 id="CODE">Source code</h4>
                <p>
                The source code of the pytorch EnPGF filter, the EnPGF lab, and the kafka streaming producer and consumer can be found in the github repository <a style="color:#c4640b" href="https://github.com/sdelahaies/enpgf-lab">enpgf-lab</a>. Running the code assumes that:
                <li style="margin-left:30px">nvidia drivers are correctly set up on the host system,</li>
                <li style="margin-left:30px">docker engine is running on the host system to operate kafka. </li>
                While all the features can run on a properly set up host sytem, we propose a <a style="color:#c4640b" href="#docker">docker install</a> to work in isolation and let the host system untouched.
                <p></p>
                <h6>EnPGF pytorch</h6>
                <p>The pytorch EnPGF code should run directly providing that requirements, essentially pytorch, are satisfied. As in the example above, in a python console import EnPGF_Lab and load a data set using the command </p>
                <div class="demo-highlight">
                  <pre>
<span class="kn">from</span> <span class="nn">EnPGF_lab</span> <span class="kn">import</span> <span class="n">*</span>
<span class="n">dN</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">nstep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dN_load</span><span class="p">(</span><span class="s1">'dN_100000_128.csv.gzip'</span><span class="p">)</span></pre></div> 
<style id="css-style">pre { line-height: 125%; }
  td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
  span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
  td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
  span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
  .demo-highlight .hll { background-color: #ffffcc }
  .demo-highlight { background: #f8f8f8; }
  .demo-highlight .c { color: #008800; font-style: italic } /* Comment */
  .demo-highlight .err { border: 1px solid #FF0000 } /* Error */
  .demo-highlight .k { color: #AA22FF; font-weight: bold } /* Keyword */
  .demo-highlight .o { color: #666666 } /* Operator */
  .demo-highlight .ch { color: #008800; font-style: italic } /* Comment.Hashbang */
  .demo-highlight .cm { color: #008800; font-style: italic } /* Comment.Multiline */
  .demo-highlight .cp { color: #008800 } /* Comment.Preproc */
  .demo-highlight .cpf { color: #008800; font-style: italic } /* Comment.PreprocFile */
  .demo-highlight .c1 { color: #008800; font-style: italic } /* Comment.Single */
  .demo-highlight .cs { color: #008800; font-weight: bold } /* Comment.Special */
  .demo-highlight .gd { color: #A00000 } /* Generic.Deleted */
  .demo-highlight .ge { font-style: italic } /* Generic.Emph */
  .demo-highlight .gr { color: #FF0000 } /* Generic.Error */
  .demo-highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
  .demo-highlight .gi { color: #00A000 } /* Generic.Inserted */
  .demo-highlight .go { color: #888888 } /* Generic.Output */
  .demo-highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
  .demo-highlight .gs { font-weight: bold } /* Generic.Strong */
  .demo-highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
  .demo-highlight .gt { color: #0044DD } /* Generic.Traceback */
  .demo-highlight .kc { color: #AA22FF; font-weight: bold } /* Keyword.Constant */
  .demo-highlight .kd { color: #AA22FF; font-weight: bold } /* Keyword.Declaration */
  .demo-highlight .kn { color: #AA22FF; font-weight: bold } /* Keyword.Namespace */
  .demo-highlight .kp { color: #AA22FF } /* Keyword.Pseudo */
  .demo-highlight .kr { color: #AA22FF; font-weight: bold } /* Keyword.Reserved */
  .demo-highlight .kt { color: #00BB00; font-weight: bold } /* Keyword.Type */
  .demo-highlight .m { color: #666666 } /* Literal.Number */
  .demo-highlight .s { color: #BB4444 } /* Literal.String */
  .demo-highlight .na { color: #BB4444 } /* Name.Attribute */
  .demo-highlight .nb { color: #AA22FF } /* Name.Builtin */
  .demo-highlight .nc { color: #0000FF } /* Name.Class */
  .demo-highlight .no { color: #880000 } /* Name.Constant */
  .demo-highlight .nd { color: #AA22FF } /* Name.Decorator */
  .demo-highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
  .demo-highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
  .demo-highlight .nf { color: #00A000 } /* Name.Function */
  .demo-highlight .nl { color: #A0A000 } /* Name.Label */
  .demo-highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
  .demo-highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
  .demo-highlight .nv { color: #B8860B } /* Name.Variable */
  .demo-highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
  .demo-highlight .w { color: #bbbbbb } /* Text.Whitespace */
  .demo-highlight .mb { color: #666666 } /* Literal.Number.Bin */
  .demo-highlight .mf { color: #666666 } /* Literal.Number.Float */
  .demo-highlight .mh { color: #666666 } /* Literal.Number.Hex */
  .demo-highlight .mi { color: #666666 } /* Literal.Number.Integer */
  .demo-highlight .mo { color: #666666 } /* Literal.Number.Oct */
  .demo-highlight .sa { color: #BB4444 } /* Literal.String.Affix */
  .demo-highlight .sb { color: #BB4444 } /* Literal.String.Backtick */
  .demo-highlight .sc { color: #BB4444 } /* Literal.String.Char */
  .demo-highlight .dl { color: #BB4444 } /* Literal.String.Delimiter */
  .demo-highlight .sd { color: #BB4444; font-style: italic } /* Literal.String.Doc */
  .demo-highlight .s2 { color: #BB4444 } /* Literal.String.Double */
  .demo-highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
  .demo-highlight .sh { color: #BB4444 } /* Literal.String.Heredoc */
  .demo-highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
  .demo-highlight .sx { color: #008000 } /* Literal.String.Other */
  .demo-highlight .sr { color: #BB6688 } /* Literal.String.Regex */
  .demo-highlight .s1 { color: #BB4444 } /* Literal.String.Single */
  .demo-highlight .ss { color: #B8860B } /* Literal.String.Symbol */
  .demo-highlight .bp { color: #AA22FF } /* Name.Builtin.Pseudo */
  .demo-highlight .fm { color: #00A000 } /* Name.Function.Magic */
  .demo-highlight .vc { color: #B8860B } /* Name.Variable.Class */
  .demo-highlight .vg { color: #B8860B } /* Name.Variable.Global */
  .demo-highlight .vi { color: #B8860B } /* Name.Variable.Instance */
  .demo-highlight .vm { color: #B8860B } /* Name.Variable.Magic */
  .demo-highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
                <p>you then instanciate and train an EnPGF model </p>
                  <div class="demo-highlight">
                    <pre>
<span class="n">enpgf</span><span class="o">=</span><span class="w"> </span><span class="n">EnPGF</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">nens</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span><span class="n">dN</span><span class="o">=</span><span class="n">dN</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">device</span><span class="o">=</span><span class="s1">'cuda'</span><span class="p">)</span>
<span class="n">enpgf</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
                    </pre>
                  </div>
                    <style id="css-style">pre { line-height: 125%; }
                    td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
                    span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
                    td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
                    span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
                    .demo-highlight .hll { background-color: #ffffcc }
                    .demo-highlight { background: #f8f8f8; }
                    .demo-highlight .c { color: #008800; font-style: italic } /* Comment */
                    .demo-highlight .err { border: 1px solid #FF0000 } /* Error */
                    .demo-highlight .k { color: #AA22FF; font-weight: bold } /* Keyword */
                    .demo-highlight .o { color: #666666 } /* Operator */
                    .demo-highlight .ch { color: #008800; font-style: italic } /* Comment.Hashbang */
                    .demo-highlight .cm { color: #008800; font-style: italic } /* Comment.Multiline */
                    .demo-highlight .cp { color: #008800 } /* Comment.Preproc */
                    .demo-highlight .cpf { color: #008800; font-style: italic } /* Comment.PreprocFile */
                    .demo-highlight .c1 { color: #008800; font-style: italic } /* Comment.Single */
                    .demo-highlight .cs { color: #008800; font-weight: bold } /* Comment.Special */
                    .demo-highlight .gd { color: #A00000 } /* Generic.Deleted */
                    .demo-highlight .ge { font-style: italic } /* Generic.Emph */
                    .demo-highlight .gr { color: #FF0000 } /* Generic.Error */
                    .demo-highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
                    .demo-highlight .gi { color: #00A000 } /* Generic.Inserted */
                    .demo-highlight .go { color: #888888 } /* Generic.Output */
                    .demo-highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
                    .demo-highlight .gs { font-weight: bold } /* Generic.Strong */
                    .demo-highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
                    .demo-highlight .gt { color: #0044DD } /* Generic.Traceback */
                    .demo-highlight .kc { color: #AA22FF; font-weight: bold } /* Keyword.Constant */
                    .demo-highlight .kd { color: #AA22FF; font-weight: bold } /* Keyword.Declaration */
                    .demo-highlight .kn { color: #AA22FF; font-weight: bold } /* Keyword.Namespace */
                    .demo-highlight .kp { color: #AA22FF } /* Keyword.Pseudo */
                    .demo-highlight .kr { color: #AA22FF; font-weight: bold } /* Keyword.Reserved */
                    .demo-highlight .kt { color: #00BB00; font-weight: bold } /* Keyword.Type */
                    .demo-highlight .m { color: #666666 } /* Literal.Number */
                    .demo-highlight .s { color: #BB4444 } /* Literal.String */
                    .demo-highlight .na { color: #BB4444 } /* Name.Attribute */
                    .demo-highlight .nb { color: #AA22FF } /* Name.Builtin */
                    .demo-highlight .nc { color: #0000FF } /* Name.Class */
                    .demo-highlight .no { color: #880000 } /* Name.Constant */
                    .demo-highlight .nd { color: #AA22FF } /* Name.Decorator */
                    .demo-highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
                    .demo-highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
                    .demo-highlight .nf { color: #00A000 } /* Name.Function */
                    .demo-highlight .nl { color: #A0A000 } /* Name.Label */
                    .demo-highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
                    .demo-highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
                    .demo-highlight .nv { color: #B8860B } /* Name.Variable */
                    .demo-highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
                    .demo-highlight .w { color: #bbbbbb } /* Text.Whitespace */
                    .demo-highlight .mb { color: #666666 } /* Literal.Number.Bin */
                    .demo-highlight .mf { color: #666666 } /* Literal.Number.Float */
                    .demo-highlight .mh { color: #666666 } /* Literal.Number.Hex */
                    .demo-highlight .mi { color: #666666 } /* Literal.Number.Integer */
                    .demo-highlight .mo { color: #666666 } /* Literal.Number.Oct */
                    .demo-highlight .sa { color: #BB4444 } /* Literal.String.Affix */
                    .demo-highlight .sb { color: #BB4444 } /* Literal.String.Backtick */
                    .demo-highlight .sc { color: #BB4444 } /* Literal.String.Char */
                    .demo-highlight .dl { color: #BB4444 } /* Literal.String.Delimiter */
                    .demo-highlight .sd { color: #BB4444; font-style: italic } /* Literal.String.Doc */
                    .demo-highlight .s2 { color: #BB4444 } /* Literal.String.Double */
                    .demo-highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
                    .demo-highlight .sh { color: #BB4444 } /* Literal.String.Heredoc */
                    .demo-highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
                    .demo-highlight .sx { color: #008000 } /* Literal.String.Other */
                    .demo-highlight .sr { color: #BB6688 } /* Literal.String.Regex */
                    .demo-highlight .s1 { color: #BB4444 } /* Literal.String.Single */
                    .demo-highlight .ss { color: #B8860B } /* Literal.String.Symbol */
                    .demo-highlight .bp { color: #AA22FF } /* Name.Builtin.Pseudo */
                    .demo-highlight .fm { color: #00A000 } /* Name.Function.Magic */
                    .demo-highlight .vc { color: #B8860B } /* Name.Variable.Class */
                    .demo-highlight .vg { color: #B8860B } /* Name.Variable.Global */
                    .demo-highlight .vi { color: #B8860B } /* Name.Variable.Instance */
                    .demo-highlight .vm { color: #B8860B } /* Name.Variable.Magic */
                    .demo-highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
                  
                  <p>To execute the code on cpu in case nvidia GPU is not available (requires torch cpu only), set   </p>
                  <div class="demo-highlight">
                    <pre>
<span class="n">device</span><span class="o">=</span><span class="s1">'cuda'</span>
                    </pre>
                  </div>
                    <style id="css-style">pre { line-height: 125%; }
                    td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
                    span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
                    td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
                    span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
                    .demo-highlight .hll { background-color: #ffffcc }
                    .demo-highlight { background: #f8f8f8; }
                    .demo-highlight .c { color: #008800; font-style: italic } /* Comment */
                    .demo-highlight .err { border: 1px solid #FF0000 } /* Error */
                    .demo-highlight .k { color: #AA22FF; font-weight: bold } /* Keyword */
                    .demo-highlight .o { color: #666666 } /* Operator */
                    .demo-highlight .ch { color: #008800; font-style: italic } /* Comment.Hashbang */
                    .demo-highlight .cm { color: #008800; font-style: italic } /* Comment.Multiline */
                    .demo-highlight .cp { color: #008800 } /* Comment.Preproc */
                    .demo-highlight .cpf { color: #008800; font-style: italic } /* Comment.PreprocFile */
                    .demo-highlight .c1 { color: #008800; font-style: italic } /* Comment.Single */
                    .demo-highlight .cs { color: #008800; font-weight: bold } /* Comment.Special */
                    .demo-highlight .gd { color: #A00000 } /* Generic.Deleted */
                    .demo-highlight .ge { font-style: italic } /* Generic.Emph */
                    .demo-highlight .gr { color: #FF0000 } /* Generic.Error */
                    .demo-highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
                    .demo-highlight .gi { color: #00A000 } /* Generic.Inserted */
                    .demo-highlight .go { color: #888888 } /* Generic.Output */
                    .demo-highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
                    .demo-highlight .gs { font-weight: bold } /* Generic.Strong */
                    .demo-highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
                    .demo-highlight .gt { color: #0044DD } /* Generic.Traceback */
                    .demo-highlight .kc { color: #AA22FF; font-weight: bold } /* Keyword.Constant */
                    .demo-highlight .kd { color: #AA22FF; font-weight: bold } /* Keyword.Declaration */
                    .demo-highlight .kn { color: #AA22FF; font-weight: bold } /* Keyword.Namespace */
                    .demo-highlight .kp { color: #AA22FF } /* Keyword.Pseudo */
                    .demo-highlight .kr { color: #AA22FF; font-weight: bold } /* Keyword.Reserved */
                    .demo-highlight .kt { color: #00BB00; font-weight: bold } /* Keyword.Type */
                    .demo-highlight .m { color: #666666 } /* Literal.Number */
                    .demo-highlight .s { color: #BB4444 } /* Literal.String */
                    .demo-highlight .na { color: #BB4444 } /* Name.Attribute */
                    .demo-highlight .nb { color: #AA22FF } /* Name.Builtin */
                    .demo-highlight .nc { color: #0000FF } /* Name.Class */
                    .demo-highlight .no { color: #880000 } /* Name.Constant */
                    .demo-highlight .nd { color: #AA22FF } /* Name.Decorator */
                    .demo-highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
                    .demo-highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
                    .demo-highlight .nf { color: #00A000 } /* Name.Function */
                    .demo-highlight .nl { color: #A0A000 } /* Name.Label */
                    .demo-highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
                    .demo-highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
                    .demo-highlight .nv { color: #B8860B } /* Name.Variable */
                    .demo-highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
                    .demo-highlight .w { color: #bbbbbb } /* Text.Whitespace */
                    .demo-highlight .mb { color: #666666 } /* Literal.Number.Bin */
                    .demo-highlight .mf { color: #666666 } /* Literal.Number.Float */
                    .demo-highlight .mh { color: #666666 } /* Literal.Number.Hex */
                    .demo-highlight .mi { color: #666666 } /* Literal.Number.Integer */
                    .demo-highlight .mo { color: #666666 } /* Literal.Number.Oct */
                    .demo-highlight .sa { color: #BB4444 } /* Literal.String.Affix */
                    .demo-highlight .sb { color: #BB4444 } /* Literal.String.Backtick */
                    .demo-highlight .sc { color: #BB4444 } /* Literal.String.Char */
                    .demo-highlight .dl { color: #BB4444 } /* Literal.String.Delimiter */
                    .demo-highlight .sd { color: #BB4444; font-style: italic } /* Literal.String.Doc */
                    .demo-highlight .s2 { color: #BB4444 } /* Literal.String.Double */
                    .demo-highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
                    .demo-highlight .sh { color: #BB4444 } /* Literal.String.Heredoc */
                    .demo-highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
                    .demo-highlight .sx { color: #008000 } /* Literal.String.Other */
                    .demo-highlight .sr { color: #BB6688 } /* Literal.String.Regex */
                    .demo-highlight .s1 { color: #BB4444 } /* Literal.String.Single */
                    .demo-highlight .ss { color: #B8860B } /* Literal.String.Symbol */
                    .demo-highlight .bp { color: #AA22FF } /* Name.Builtin.Pseudo */
                    .demo-highlight .fm { color: #00A000 } /* Name.Function.Magic */
                    .demo-highlight .vc { color: #B8860B } /* Name.Variable.Class */
                    .demo-highlight .vg { color: #B8860B } /* Name.Variable.Global */
                    .demo-highlight .vi { color: #B8860B } /* Name.Variable.Instance */
                    .demo-highlight .vm { color: #B8860B } /* Name.Variable.Magic */
                    .demo-highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>

                <h6>EnPGF Lab app</h6>
                <p>The app requires essentially dash components (see requirements) and can be run with </p>
                <div class="demo-highlight"><pre>
<span class="n">python</span> <span class="n">app.py</span></pre></div> 
<style id="css-style">pre { line-height: 125%; }
  td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
  span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
  td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
  span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
  .demo-highlight .hll { background-color: #ffffcc }
  .demo-highlight { background: #f8f8f8; }
  .demo-highlight .c { color: #008800; font-style: italic } /* Comment */
  .demo-highlight .err { border: 1px solid #FF0000 } /* Error */
  .demo-highlight .k { color: #AA22FF; font-weight: bold } /* Keyword */
  .demo-highlight .o { color: #666666 } /* Operator */
  .demo-highlight .ch { color: #008800; font-style: italic } /* Comment.Hashbang */
  .demo-highlight .cm { color: #008800; font-style: italic } /* Comment.Multiline */
  .demo-highlight .cp { color: #008800 } /* Comment.Preproc */
  .demo-highlight .cpf { color: #008800; font-style: italic } /* Comment.PreprocFile */
  .demo-highlight .c1 { color: #008800; font-style: italic } /* Comment.Single */
  .demo-highlight .cs { color: #008800; font-weight: bold } /* Comment.Special */
  .demo-highlight .gd { color: #A00000 } /* Generic.Deleted */
  .demo-highlight .ge { font-style: italic } /* Generic.Emph */
  .demo-highlight .gr { color: #FF0000 } /* Generic.Error */
  .demo-highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
  .demo-highlight .gi { color: #00A000 } /* Generic.Inserted */
  .demo-highlight .go { color: #888888 } /* Generic.Output */
  .demo-highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
  .demo-highlight .gs { font-weight: bold } /* Generic.Strong */
  .demo-highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
  .demo-highlight .gt { color: #0044DD } /* Generic.Traceback */
  .demo-highlight .kc { color: #AA22FF; font-weight: bold } /* Keyword.Constant */
  .demo-highlight .kd { color: #AA22FF; font-weight: bold } /* Keyword.Declaration */
  .demo-highlight .kn { color: #AA22FF; font-weight: bold } /* Keyword.Namespace */
  .demo-highlight .kp { color: #AA22FF } /* Keyword.Pseudo */
  .demo-highlight .kr { color: #AA22FF; font-weight: bold } /* Keyword.Reserved */
  .demo-highlight .kt { color: #00BB00; font-weight: bold } /* Keyword.Type */
  .demo-highlight .m { color: #666666 } /* Literal.Number */
  .demo-highlight .s { color: #BB4444 } /* Literal.String */
  .demo-highlight .na { color: #BB4444 } /* Name.Attribute */
  .demo-highlight .nb { color: #AA22FF } /* Name.Builtin */
  .demo-highlight .nc { color: #0000FF } /* Name.Class */
  .demo-highlight .no { color: #880000 } /* Name.Constant */
  .demo-highlight .nd { color: #AA22FF } /* Name.Decorator */
  .demo-highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
  .demo-highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
  .demo-highlight .nf { color: #00A000 } /* Name.Function */
  .demo-highlight .nl { color: #A0A000 } /* Name.Label */
  .demo-highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
  .demo-highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
  .demo-highlight .nv { color: #B8860B } /* Name.Variable */
  .demo-highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
  .demo-highlight .w { color: #bbbbbb } /* Text.Whitespace */
  .demo-highlight .mb { color: #666666 } /* Literal.Number.Bin */
  .demo-highlight .mf { color: #666666 } /* Literal.Number.Float */
  .demo-highlight .mh { color: #666666 } /* Literal.Number.Hex */
  .demo-highlight .mi { color: #666666 } /* Literal.Number.Integer */
  .demo-highlight .mo { color: #666666 } /* Literal.Number.Oct */
  .demo-highlight .sa { color: #BB4444 } /* Literal.String.Affix */
  .demo-highlight .sb { color: #BB4444 } /* Literal.String.Backtick */
  .demo-highlight .sc { color: #BB4444 } /* Literal.String.Char */
  .demo-highlight .dl { color: #BB4444 } /* Literal.String.Delimiter */
  .demo-highlight .sd { color: #BB4444; font-style: italic } /* Literal.String.Doc */
  .demo-highlight .s2 { color: #BB4444 } /* Literal.String.Double */
  .demo-highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
  .demo-highlight .sh { color: #BB4444 } /* Literal.String.Heredoc */
  .demo-highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
  .demo-highlight .sx { color: #008000 } /* Literal.String.Other */
  .demo-highlight .sr { color: #BB6688 } /* Literal.String.Regex */
  .demo-highlight .s1 { color: #BB4444 } /* Literal.String.Single */
  .demo-highlight .ss { color: #B8860B } /* Literal.String.Symbol */
  .demo-highlight .bp { color: #AA22FF } /* Name.Builtin.Pseudo */
  .demo-highlight .fm { color: #00A000 } /* Name.Function.Magic */
  .demo-highlight .vc { color: #B8860B } /* Name.Variable.Class */
  .demo-highlight .vg { color: #B8860B } /* Name.Variable.Global */
  .demo-highlight .vi { color: #B8860B } /* Name.Variable.Instance */
  .demo-highlight .vm { color: #B8860B } /* Name.Variable.Magic */
  .demo-highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
                <p>it is then available at the address 0.0.0.0:8889 .</p>

                <h6>kafka online training</h6>
                <p>
                The online training framework requires a running apache streaming platform. Providing that the requirements are satisfied, the producer <span style="font-family: monospace;font-size: 14px;">producer_spikes.py</span>  and consumer <span style="font-family: monospace;font-size: 14px;">consumer_spikes.py</span> can be excuted on a running kafka server after setting the <span style="font-family: monospace;font-size: 14px;">bootstrap_servers</span> address accordingly.
                </p>

                <h6 id="docker">docker install</h6>
                <p>The docker install facilitates the installation of the packages by providing an isolated framework. From a terminal run the commands </p>
                <div class="demo-highlight">
                  <pre>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https://github.com/sdelahaies/enpgf_lab.git</span>
<span class="n">cd</span> <span class="n">enpgf_lab</span>
<span class="n">docker</span> <span class="n">compose</span> <span class="n">up</span> <span class="n">-d</span></pre></div>
                <p>    
                which install and set up and start the following containers:
                <li style="margin-left:30px">enpgf-lab: a minimal ubuntu 22.04 distribution with nvidia-cuda toolkit and required packages (torch, dash, kafka, ...) which starts the app and make it avalaible at 127.0.0.1:60001. A terminal bash is available by running the command
                </p>  
                <div class="demo-highlight">
                    <pre>
<span class="n">docker</span> <span class="n">exec</span> <span class="n">-it</span> <span class="n">enpgf-lab</span> <span class="n">/bin/bash</span></pre></div>
                <p>from which you can start a python or ipython console, or start a jupyter session via the command</p>
                <div class="demo-highlight">
                  <pre>
<span class="n">jupyter</span> <span class="n">notebook</span> <span class="n">--ip</span> <span class="n">0.0.0.0</span> <span class="n">--no-browser</span> <span class="n">--allow-root</span></pre></div>
                <p>available at 127.0.0.1:60000</p>
                </li> 
                <li style="margin-left:30px">kafka: a kafka broker which organizes and stores streams of events</li> 
                <li style="margin-left:30px">kafka-ui: a simple dashboard to monitor the flow of data produced and consumed, available at 127.0.0.1:8080 .</li> 
                
                <h4 id="REF">References</h4>
              
                <p id="ref1">[1] N. Santitissadeekorn, S. Delahaies, D.J.B. Lloyd, <a href="https://doi.org/10.1016/j.physd.2023.133676">Identification of an influence network using ensemble-based filtering for Hawkes processes driven by count data</a>, Physica D: Nonlinear Phenomena</p>
                <p id="ref2">[2] N. Santitissadeekorn, D. J. B. Lloyd, M. B. Short, and S. Delahaies, <a href="https://doi.org/10.1016/j.csda.2019.106850">Approximate filtering of conditional intensity process for poisson count data: Application to urban crime</a>, Computational Statistics & Data Analysis.</p>
                <p>
                </p>    
                       
              </div>
            </div>

<!--
            <div class="box-comments">
              <div class="title-box-2">
                <h4 class="title-comments title-left">Comments (34)</h4>
              </div>
              <ul class="list-comments">
                <li>
                  <div class="comment-avatar">
                    <img src="assets/img/testimonial-2.jpg" alt="">
                  </div>
                  <div class="comment-details">
                    <h4 class="comment-author">Oliver Colmenares</h4>
                    <span>18 Sep 2017</span>
                    <p>
                      Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolores reprehenderit, provident cumque
                      ipsam temporibus maiores
                      quae natus libero optio, at qui beatae ducimus placeat debitis voluptates amet corporis.
                    </p>
                    <a href="3">Reply</a>
                  </div>
                </li>
                <li>
                  <div class="comment-avatar">
                    <img src="assets/img/testimonial-4.jpg" alt="">
                  </div>
                  <div class="comment-details">
                    <h4 class="comment-author">Carmen Vegas</h4>
                    <span>18 Sep 2017</span>
                    <p>
                      Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolores reprehenderit, provident cumque
                      ipsam temporibus maiores
                      quae natus libero optio, at qui beatae ducimus placeat debitis voluptates amet corporis,
                      veritatis deserunt.
                    </p>
                    <a href="3">Reply</a>
                  </div>
                </li>
                <li class="comment-children">
                  <div class="comment-avatar">
                    <img src="assets/img/testimonial-2.jpg" alt="">
                  </div>
                  <div class="comment-details">
                    <h4 class="comment-author">Oliver Colmenares</h4>
                    <span>18 Sep 2017</span>
                    <p>
                      Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolores reprehenderit, provident cumque
                      ipsam temporibus maiores
                      quae.
                    </p>
                    <a href="3">Reply</a>
                  </div>
                </li>
                <li>
                  <div class="comment-avatar">
                    <img src="assets/img/testimonial-2.jpg" alt="">
                  </div>
                  <div class="comment-details">
                    <h4 class="comment-author">Oliver Colmenares</h4>
                    <span>18 Sep 2017</span>
                    <p>
                      Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolores reprehenderit, provident cumque
                      ipsam temporibus maiores
                      quae natus libero optio.
                    </p>
                    <a href="3">Reply</a>
                  </div>
                </li>
              </ul>
            </div>

            <div class="form-comments">
              <div class="title-box-2">
                <h3 class="title-left">
                  Leave a Reply
                </h3>
              </div>
              <form class="form-mf">
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <div class="form-group">
                      <input type="text" class="form-control input-mf" id="inputName" placeholder="Name *" required>
                    </div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <div class="form-group">
                      <input type="email" class="form-control input-mf" id="inputEmail1" placeholder="Email *" required>
                    </div>
                  </div>
                  <div class="col-md-12 mb-3">
                    <div class="form-group">
                      <input type="url" class="form-control input-mf" id="inputUrl" placeholder="Website">
                    </div>
                  </div>
                  <div class="col-md-12 mb-3">
                    <div class="form-group">
                      <textarea id="textMessage" class="form-control input-mf" placeholder="Comment *" name="message" cols="45" rows="8" required></textarea>
                    </div>
                  </div>
                  <div class="col-md-12">
                    <button type="submit" class="button button-a button-big button-rouded">Send Message</button>
                  </div>
                </div>
              </form>
            </div>
-->


          </div>
          <div class="col-md-4">

            <!--
            <div class="widget-sidebar sidebar-search">
              <h5 class="sidebar-title">Search</h5>
              <div class="sidebar-content">
                <form>
                  <div class="input-group">
                    <input type="text" class="form-control" placeholder="Search for..." aria-label="Search for...">
                    <span class="input-group-btn">
                      <button class="btn btn-secondary btn-search" type="button">
                        <span class="bi bi-search"></span>
                      </button>
                    </span>
                  </div>
                </form>
              </div>
            </div>
            -->

            <div class="widget-sidebar">
              <h5 class="sidebar-title">Recent Post</h5>
              <div class="sidebar-content">
                <ul class="list-sidebar">
                  <li>
                    <a href="chatgpt-prompts2.html">Is ChatGPT ruining my Data Engineer career before it even started? TAKE 2
                  </li>  
                  <li>
                    <a href="chatgpt-prompts.html">Is Chatgpt ruining my Data Engineer career before it even started?
                  </li>    
                  
                  <li>
                    <a href="#">Online EnPGF training for temporal point processes</a>
                  </li>
                  <li>
                    <a href="travelplanner.html">Travel planner</a>
                  </li>
                  <li>
                    <a href="#">4DEnsVar</a>
                  </li>
                  <li>
                    <a href="#">OCNI bot</a>
                  </li>
                </ul>
              </div>
            </div>

            <div class="widget-sidebar widget-tags">
              <h5 class="sidebar-title">Tags</h5>
              <div class="sidebar-content">
                <ul>
                  <li>
                    <a href="#">EnPGf</a>
                  </li>
                  <li>
                    <a href="#">Hawkes process</a>
                  </li>
                  <li>
                    <a href="#">Sequential filter</a>
                  </li>
                  <li>
                    <a href="#">Pytorch</a>
                  </li>
                  <li>
                    <a href="#">kafka</a>
                  </li>
                  <li>
                    <a href="#">Data Assimilation</a>
                  </li>
                  <li>
                    <a href="#">Dash</a>
                  </li>
                  <li>
                    <a href="#">Data Engineering</a>
                  </li>
                  <li>
                    <a href="#">nvidia RTX 3080</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section><!-- End Blog Single Section -->

  </main><!-- End #main -->


  <!-- ======= Footer ======= -->
  <footer>
    <div class="container">
      <div class="row">
        <div class="col-sm-12">
          <div class="copyright-box">
            <p class="copyright">&copy; <strong>2023 S. delahaies</strong></p>
            <!--
            <div class="credits">
              con√ßu avec <a href="https://bootstrapmade.com/devfolio-bootstrap-portfolio-html-template/"> DevFolio</a>, h√©berg√© par <a href="https://github.com/">Github</a>  
            </div>
            -->
          </div>
        </div>
      </div>
    </div>
  </footer><!-- End  Footer -->

  <div id="preloader"></div>
  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <script src="assets/js/bootstrap.bundle.min.js"></script>
  <script src="assets/js/glightbox.min.js"></script>
  <script src="assets/js/swiper-bundle.min.js"></script>
  <script src="assets/js/typed.min.js"></script>
  <script src="assets/js/ob_mail.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script>
  <script src="assets/js/tl_script.js"></script>
  <script src="assets/js/main.js"></script>

</body>

</html>